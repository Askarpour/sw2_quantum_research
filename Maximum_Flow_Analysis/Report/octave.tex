%!TEX root = main.tex

\chapter{Quantum gates in Octave}
\label{octave}

Octave is a free software and a scientific programming language whose syntax is largely compatible with Matlab.

To fill the gap between some theoretical papers (which perform calculations on matrices) and quantum gates (that are eventually how those matrices are implemented) we modeled some quantum matrices as combination of known gates. In this way it was possible to investigate on how such matrices could be really implemented.

\section{Elementary (existing) gates}

\subsection{Hadamard and X, Y, Z}

We will show only $H$ as an example, but the same applies for $X$, $Y$ and $Z$ and in general for $2 \times 2$ gates.

\subsubsection{Matrix}

\begin{equation*}
H =
\frac{1}{\sqrt{2}}
\begin{bmatrix}
1 & 1 \\
1 & -1
\end{bmatrix}
\end{equation*}

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \gate{H} & \qw \\
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
H = [
1,  1; 
1,  -1
]./sqrt(2);
\end{lstlisting}

\subsection{CNOT}

\subsubsection{Matrix}

\begin{equation*}
CNOT =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 1 & 0 \\
\end{bmatrix}
\end{equation*}

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \ctrl{1} & \qw \\
	\lstick{b_{1}: } & \targ    & \qw \\
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
CNOT = C(X);
\end{lstlisting}

\subsection{SWAP}

\subsubsection{Matrix}

\begin{equation*}
SWAP =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 \\
\end{bmatrix}
\end{equation*}

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \qswap      & \qw \\
	\lstick{b_{1}: } & \qswap \qwx & \qw \\
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
SWAP = [
1, 0, 0, 0;
0, 0, 1, 0;
0, 1, 0, 0;
0, 0, 0, 1;
];
\end{lstlisting}

\subsection{CCNOT}

\subsubsection{Matrix}

\[
CCNOT =
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
\end{bmatrix}
\]

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \ctrl{1} & \qw\\
	\lstick{b_{1}: } & \ctrl{1} & \qw\\
	\lstick{b_{2}: } & \targ    & \qw\\
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
CCNOT = C(CNOT);
\end{lstlisting}

\subsection{CSWAP}

\subsubsection{Matrix}

\[
CSWAP =
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{bmatrix}
\]

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \ctrl{1}    & \qw\\
	\lstick{b_{1}: } & \qswap      & \qw\\
	\lstick{b_{2}: } & \qswap \qwx & \qw\\
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
CSWAP = C(SWAP);
\end{lstlisting}

\section{Operations between gates}

\subsection{Kronecker product (or direct product)}

\subsubsection{Matrix}
\[
H \otimes H =
\frac{1}{\sqrt{2}}
\begin{bmatrix}
1 & 1 \\
1 & -1
\end{bmatrix}
\otimes
\frac{1}{\sqrt{2}}
\begin{bmatrix}
1 & 1 \\
1 & -1
\end{bmatrix}
=
\frac{1}{2}
\begin{bmatrix}
1 & 1 & 1 & 1 \\
1 & -1 & 1 & -1 \\
1 & 1 & -1 & -1 \\
1 & -1 & -1 & 1 \\
\end{bmatrix}
\]
\subsubsection{Circuit}

\begin{equation*}
	\Qcircuit @R=1em @!R {
		\lstick{b_{0}: } & \gate{H} & \qw \\
		\lstick{b_{1}: } & \gate{H} & \qw \\
	}
\end{equation*}

\subsubsection{Code}

\begin{lstlisting}
kron(H, H);
\end{lstlisting}

\subsection{Gate control (direct sum)}

\subsubsection{Matrix}
\[
I \oplus H =
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
\oplus
\begin{bmatrix}
\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\
\frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\
0 & 0 & \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\
\end{bmatrix}
\]

Note that CNOT is a ``controlled $X$''.

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \ctrl{1} & \qw \\
	\lstick{b_{1}: } & \gate{H} & \qw \\
}
\end{equation*}

\subsubsection{Code}

\begin{lstlisting}
function out = C(gate)
	size = rows(gate);
	out = blkdiag(eye(size), gate);
endfunction;
\end{lstlisting}

\section{New (derivated) gates}

\subsection{DSWAP: double corner swap}

\subsubsection{Matrix}

\[
SWAP =
\begin{bmatrix}
0 & 1 & 0 & 0 \\
1 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 1 & 0 \\
\end{bmatrix}
\]

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \qw      & \qw \\
	\lstick{b_{1}: } & \gate{X} & \qw \gategroup{1}{2}{2}{2}{1em}{--}
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
SWAP = kron(eye(2), X);
\end{lstlisting}

\subsection{ICNOT: inverted CNOT}

\subsubsection{Matrix}

\[
ICNOT =
\begin{bmatrix}
0 & 1 & 0 & 0 \\
1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
\end{bmatrix}
\]

Note that \textbf{it is not equivalent} to this circuit:

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \targ     & \qw \\
	\lstick{b_{1}: } & \ctrl{-1} & \qw \\
}
\end{equation*}

whose matrix is:

\[
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 1 & 0 \\
0 & 1 & 0 & 0 \\
\end{bmatrix}
\]

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \multigate{1}{DSWAP} & \ctrl{1} & \qw \\
	\lstick{b_{1}: } & \ghost{DWAP}         & \targ    & \qw \\
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
ICNOT = DSWAP * CNOT;
\end{lstlisting}

\subsection{CNOT3}

CNOT of grade 3.

\subsubsection{Matrix}

\begin{equation*}
CNOT3 =
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
\end{bmatrix}
\end{equation*}

Please note that it is different from CCNOT.

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \multigate{1}{CNOT} & \qw \\
	\lstick{b_{1}: } & \ghost{CNOT}    & \qw \\
	\lstick{b_{2}: } & \qw      & \qw \gategroup{1}{2}{3}{2}{1em}{--}
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
CNOT3 = kron(CNOT, eye(2));
\end{lstlisting}

\subsection{SWAP3}

\subsubsection{Matrix}

\begin{equation*}
SWAP3 =
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{bmatrix}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
SWAP3 = kron(SWAP, eye(2));
\end{lstlisting}

\subsection{SHIFT3}

\subsubsection{Matrix}

\begin{equation*}
SHIFT3 =
\begin{bmatrix}
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
\end{bmatrix}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
SHIFT3 = kron(SHIFT, eye(2));
\end{lstlisting}

\subsection{CNOT4}

CNOT of grade 3.

\subsubsection{Matrix}

\setcounter{MaxMatrixCols}{16}
\begin{equation*}
CNOT4 =
\begin{bmatrix}
\tikzmark{l1} 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\tikzmark{r1} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \tikzmark{l2}1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\tikzmark{r2}\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \tikzmark{l3}1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\tikzmark{r3} & 0 & 0 & 0 & 0\\
\end{bmatrix}
\end{equation*}

\DrawBox[thick, blue, dashed]{l1}{r1}{}
\DrawBox[thick, blue, dashed]{l2}{r2}{}
\DrawBox[thick, blue, dashed]{l3}{r3}{}


Please note that it is different from CCCNOT.

\subsubsection{Circuit}

\begin{equation*}
\Qcircuit @R=1em @!R {
	\lstick{b_{0}: } & \multigate{1}{CNOT} & \qw \\
	\lstick{b_{1}: } & \ghost{CNOT}    & \qw \\
	\lstick{b_{2}: } & \qw      & \qw\\
	\lstick{b_{2}: } & \qw      & \qw \gategroup{1}{2}{4}{2}{1em}{--}
}
\end{equation*}

\subsubsection{Octave code}
\begin{lstlisting}
CNOT4 = kron(CNOT, eye(4));
\end{lstlisting}

%todo ripulire da cose che ho gi√† messo nell'intro